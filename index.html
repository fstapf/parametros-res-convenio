<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cadastro de Convênios</title>
<style>
  :root{
    --accent:#0078D7; --face:#f3f3f3; --panel:#ffffff; --text:#111;
    --muted:#666; --line:#c7ccd5; --line2:#b8bcc4; --shadow:rgba(0,0,0,.18);
    --font:'Segoe UI','Tahoma','MS Sans Serif',sans-serif;
  }
  html,body{height:100%;margin:0;background:#dde7f4}
  body{font:11px var(--font);color:var(--text)}
  .app-shell{display:none}

  /* ===== janela ===== */
  .window{width:980px;max-width:calc(100vw - 40px);margin:18px auto;background:var(--panel);
          border-radius:6px;box-shadow:0 18px 45px var(--shadow);overflow:hidden;border:1px solid #c8d0dc}
  .titlebar{background:var(--accent);color:#fff;height:28px;display:flex;align-items:center;padding:0 10px;font-weight:600}
  .content{padding:10px}
  .caption{display:flex;align-items:center;gap:8px;color:#0a2a5e;font-weight:600;margin:2px 0 8px}
  .caption::before{content:"";width:12px;height:12px;border-radius:2px;background:#0aa29a;box-shadow:0 0 0 1px rgba(0,0,0,.2) inset}

  /* ===== header ===== */
  .header{background:var(--face);border:1px solid var(--line);border-radius:6px;padding:8px}
  .grid{display:grid;grid-template-columns:60px minmax(85px, 1fr) 60px minmax(280px, 2fr) minmax(80px, 1fr) minmax(180px, 1.5fr);
        grid-auto-rows:24px;column-gap:10px;row-gap:8px;align-items:center}
  .label{color:#222;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .edit,.combo{height:22px;padding:1px 6px;border:1px solid var(--line2);border-radius:4px;background:#fff;font:11px var(--font);width:100%;max-width:100%;box-sizing:border-box}
  .combo{padding:0 4px}
  .chk{display:flex;align-items:center;gap:6px;color:#222}
  .checkrow{grid-column:6/7;display:flex;gap:14px;align-items:center}

  /* Exceções - campos que devem manter tamanho específico */
  .e-codigo { width: 85px; }
  .e-grupo { width: 90px; }
  .e-ibge { width: 85px; }
  .e-uf { width: 70px; }
  .e-cep { width: 130px; }
  .e-desc { width: 80px; }
  .e-sit { width: 110px; }
  .e-numero { width: 120px; }
  .e-class { width: 170px; }

  /* Campos da 6ª coluna usam 100% do espaço disponível */
  .e-contato, .e-cnpj, .e-complemento, .e-telefone, .e-bairro {
    width: 100% !important;
  }

  /* posições (bem próximas do teu print) */
  .c-codigo{grid-column:1/2}.e-codigo{grid-column:2/3}
  .c-nome{grid-column:3/4}.e-nome{grid-column:4/5}
  .c-contato{grid-column:5/6}.e-contato{grid-column:6/7}
  .c-grupo{grid-column:1/2;grid-row:2}.e-grupo{grid-column:2/3;grid-row:2}
  .c-grupo2{grid-column:3/4;grid-row:2}.e-grupo2{grid-column:4/5;grid-row:2}
  .c-cnpj{grid-column:5/6;grid-row:2}.e-cnpj{grid-column:6/7;grid-row:2}
  .c-local{grid-column:1/2;grid-row:3}.e-local{grid-column:2/3;grid-row:3}
  .c-numero{grid-column:3/4;grid-row:3}.e-numero{grid-column:4/5;grid-row:3}
  .c-complemento{grid-column:5/6;grid-row:3}.e-complemento{grid-column:6/7;grid-row:3}
  .c-ibge{grid-column:1/2;grid-row:4}.e-ibge{grid-column:2/3;grid-row:4}
  .c-cidade{grid-column:3/4;grid-row:4}.e-cidade{grid-column:4/5;grid-row:4}
  .c-telefone{grid-column:5/6;grid-row:4}.e-telefone{grid-column:6/7;grid-row:4}
  .c-uf{grid-column:1/2;grid-row:5}.e-uf{grid-column:2/3;grid-row:5}
  .c-cep{grid-column:3/4;grid-row:5}.e-cep{grid-column:4/5;grid-row:5}
  .c-desc{grid-column:5/6;grid-row:5}.e-desc{grid-column:6/7;grid-row:5}
  .c-sit{grid-column:1/2;grid-row:6}.e-sit{grid-column:2/3;grid-row:6}
  .c-class{grid-column:3/4;grid-row:6}.e-class{grid-column:4/5;grid-row:6}
  .c-bairro{grid-column:5/6;grid-row:6}.e-bairro{grid-column:6/7;grid-row:6}
  .checkrow{grid-row:7}

  /* ===== tabs estilo pagecontrol ===== */
  .pc{margin-top:10px}
  .pc-head{display:flex;gap:4px;flex-wrap:wrap;border-bottom:1px solid var(--line)}
  .pc-tab{position:relative;top:1px;padding:5px 10px;border:1px solid var(--line);border-bottom:none;border-radius:6px 6px 0 0;
          background:linear-gradient(#fff,#f6f7f9);cursor:pointer;user-select:none}
  .pc-tab.active{background:#fff;color:#0a2a5e;font-weight:600;border-color:#bfc6d3}
  .pc-body{background:#fff;border:1px solid #bfc6d3;border-radius:0 6px 6px 6px;padding:10px;min-height:300px}

  /* ===== groupbox ===== */
  .groupbox{border:1px solid var(--line);border-radius:6px;padding:12px 10px 8px;margin:8px 4px}
  .groupbox .title{position:relative;top:-22px;display:inline-block;padding:0 6px;margin-bottom:-10px;background:#fff;color:#0a2a5e;font-weight:600}

  /* ===== grid de credenciais ===== */
  table.grid{width:100%;border-collapse:separate;border-spacing:0;margin-top:6px;border:1px solid var(--line2);border-radius:6px;overflow:hidden;min-height:120px}
  table.grid th{background:#f6f8fb;color:#111;text-align:left;padding:8px 12px;font-weight:600;border-bottom:1px solid var(--line2);font-size:12px}
  table.grid td{padding:8px 12px;border-bottom:1px solid #e1e5ec;color:#333;font-size:11px}
  table.grid tbody tr:nth-child(even) td{background:#fafbfd}
  table.grid tbody tr:hover td{background:#f0f7ff}
  tr.selected td{background:#e6f2ff !important;color:#0a2a5e;font-weight:500}

  .row{display:flex;align-items:center;gap:8px;margin:6px 0}
  .btn{height:24px;padding:0 12px;border-radius:4px;border:1px solid var(--line2);background:linear-gradient(#fff,#f5f6f8);cursor:pointer}
  .btn:active{background:#eef1f5}

  /* ===== modal teste ===== */
  .modal{display:none;position:absolute;inset:0;background:rgba(0,0,0,.25);align-items:center;justify-content:center;z-index:20}
  .modal-card{width:320px;background:#fff;border:1px solid var(--line);border-radius:8px;box-shadow:0 10px 28px var(--shadow)}
  .modal-h{background:var(--accent);color:#fff;padding:6px 10px;border-radius:8px 8px 0 0;font-weight:600}
  .modal-b{padding:14px;text-align:center}
  .spinner{width:30px;height:30px;border-radius:50%;border:3px solid #cfd6df;border-top-color:var(--accent);margin:2px auto 10px;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .msg-error{color:#b00020}.msg-ok{color:#0a8a2a}

  /* ===== rodapé ===== */
  .footer{margin-top:10px;display:flex;gap:8px}

  /* ===== overlay de acesso ===== */
  .gate{position:fixed;inset:0;background:linear-gradient(135deg,#0d47a1 0%,#1976d2 60%,#42a5f5 100%);
        display:flex;align-items:center;justify-content:center;padding:24px;z-index:9999}
  .gate-card{width:360px;max-width:92vw;background:#fff;border-radius:10px;box-shadow:0 22px 48px rgba(0,0,0,.35);border:1px solid #c8d0dc;overflow:hidden}
  .gate-h{background:var(--accent);color:#fff;padding:10px 14px;font-weight:700}
  .gate-b{padding:16px}
  .gate-row{display:flex;gap:8px;align-items:center}
  .gate-input{flex:1;height:34px;border:1px solid var(--line2);border-radius:6px;padding:0 10px;font:13px var(--font)}
  .gate-btn{height:34px;padding:0 14px;border:none;border-radius:6px;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
  .gate-error{color:#b00020;margin-top:8px;min-height:18px}
  .hint{color:var(--muted)}
</style>
</head>
<body>

<!-- Gate -->
<div class="gate" id="gate">
  <div class="gate-card">
    <div class="gate-h">Acesso restrito</div>
    <div class="gate-b">
      <div class="gate-row" style="margin-bottom:10px">
        <input id="gateCode" class="gate-input" placeholder="Informe o número da Issue no Jira" />
        <button id="gateBtn" class="gate-btn">Entrar</button>
      </div>
      <div id="gateError" class="gate-error"></div>
      <div class="hint">A página só é exibida após validação do código.</div>
    </div>
  </div>
</div>

<!-- App -->
<div class="app-shell" id="app">
  <div class="window">
    <div class="titlebar">Cadastro de Convênios</div>
    <div class="content">
      <!-- Header -->
      <div class="groupbox">
        <span class="title">Manutenção</span>
        <div class="header" style="border: none; background: transparent; padding: 0;">
        <div class="grid">
          <div class="label c-codigo">Código</div>
          <input class="edit e-codigo" value="0002">

          <div class="label c-nome">Nome</div>
          <input class="edit e-nome" value="PARTICULAR">

          <div class="label c-contato">Contato</div>
          <input class="edit e-contato">

          <div class="label c-grupo">Grupo</div>
          <select class="combo e-grupo"><option>01</option><option>02</option></select>

          <div class="label c-grupo2">Tipo Convênioc</div>
          <select class="combo e-grupo2">
            <option>01-PARTICULARES</option><option>02-CONVÊNIOS</option>
          </select>

          <div class="label c-cnpj">N° do C.N.P.J.</div>
          <input class="edit e-cnpj" value="00.000.000/0001-91">

          <div class="label c-local">Local</div>
          <input class="edit e-local">

          <div class="label c-numero">Número</div>
          <input class="edit e-numero" value="00000">

          <div class="label c-complemento">Complemento</div>
          <input class="edit e-complemento">

          <div class="label c-ibge">IBGE</div>
          <input class="edit e-ibge" value="000000">

          <div class="label c-cidade">Cidade</div>
          <input class="edit e-cidade">

          <div class="label c-telefone">Telefone</div>
          <input class="edit e-telefone">

          <div class="label c-uf">UF</div>
          <select class="combo e-uf"><option>MG</option><option>BA</option><option>SP</option></select>

          <div class="label c-cep">CEP</div>
          <input class="edit e-cep" value="00000-000">

          <div class="label c-desc">Desconto %</div>
          <input class="edit e-desc" value="0,00">

          <div class="label c-sit">Situação</div>
          <select class="combo e-sit"><option>Ativo</option><option>Inativo</option></select>

          <div class="label c-class">Classificação</div>
          <select class="combo e-class"><option>Particular</option><option>Convênio</option></select>

          <div class="label c-bairro">Bairro</div>
          <input class="edit e-bairro">

          <div class="checkrow">
            <label class="chk"><input type="checkbox"> Utilizar C.I.D - 10</label>
            <label class="chk"><input type="checkbox"> Obrigatório</label>
          </div>
        </div>
        </div>
      </div>

      <!-- Tabs de cima (decorativas) -->
      <div class="pc" style="margin-top:8px">
        <div class="pc-head">
          <div class="pc-tab active">Tabelas</div>
          <div class="pc-tab">Complemento</div>
          <div class="pc-tab">Perc. incidência</div>
          <div class="pc-tab">Data p/valores</div>
          <div class="pc-tab">Cód. específicos</div>
          <div class="pc-tab">Valor filme</div>
          <div class="pc-tab">Diárias/Taxas</div>
          <div class="pc-tab">Percentuais</div>
          <div class="pc-tab">Diversos</div>
          <div class="pc-tab">Outros dados</div>
          <div class="pc-tab">Integrações</div>
        </div>
      </div>

      <!-- PageControl -->
      <div class="pc" id="pc">
        <div class="pc-head" id="pcHead">
          <div class="pc-tab active" data-k="fin">Financeiro/Contábil</div>
          <div class="pc-tab" data-k="ip">Ipergs</div>
          <div class="pc-tab" data-k="fr">Frente de caixa</div>
          <div class="pc-tab" data-k="res">Integrações RES</div>
        </div>
        <div class="pc-body">
          <section id="tab-fin">
            <div class="groupbox"><span class="title">Integrações Financeiro/Contábil (filtros para integração)</span>
              <div class="row" style="color:var(--muted)">Conteúdo simulado.</div>
            </div>
          </section>

          <section id="tab-ip" style="display:none">
            <div class="groupbox"><span class="title">Ipergs</span>
              <div class="row" style="color:var(--muted)">Conteúdo simulado.</div>
            </div>
          </section>

          <section id="tab-fr" style="display:none">
            <div class="groupbox"><span class="title">Frente de caixa</span>
              <div class="row" style="color:var(--muted)">Conteúdo simulado.</div>
            </div>
          </section>

          <!-- ===== Integrações RES ===== -->
          <section id="tab-res" style="display:none;position:relative">
            <div class="groupbox" style="margin: 4px; padding: 8px;">
              <span class="title">Serviço RES</span>
              <div class="row" style="margin: 4px 0;">
                <label class="label" for="cmbServico" style="width:60px">Serviço:</label>
                <select id="cmbServico" class="combo" style="width:200px">
                  <option value="">Selecione...</option>
                  <option value="planserv">Planserv</option>
                  <option value="unimed">Unimed Brasil</option>
                  <option value="rnds">RNDS</option>
                </select>
              </div>
            </div>

            <div class="groupbox" style="padding: 16px 12px 12px;">
              <span class="title">Credenciais</span>
              <div class="row" style="margin: 8px 0;">
                <label class="label" style="width:80px" for="edtChave">Chave:</label>
                <input id="edtChave" class="edit" style="width:220px" placeholder="Ex: APIKey, ClientId">
                <label class="label" style="width:50px" for="edtValor">Valor:</label>
                <input id="edtValor" class="edit" style="width:240px" type="password" placeholder="Digite o valor">
                <button id="btnAdicionar" class="btn">📝 Incluir</button>
              </div>

              <table id="tblCredenciais" class="grid" style="margin-top: 12px;">
                <thead><tr><th style="padding: 8px 12px; width: 50%;">Chave</th><th style="padding: 8px 12px; width: 50%;">Valor</th></tr></thead>
                <tbody></tbody>
              </table>
              <div class="row" style="margin-top: 10px;"><button id="btnRemoverSelecionada" class="btn" disabled>Excluir</button></div>
            </div>

            <div class="groupbox" style="margin: 4px; padding: 8px;">
              <span class="title">Ambiente</span>
              <div class="row" style="display: flex; align-items: center; gap: 20px; margin: 6px 0;">
                <label class="chk"><input type="radio" name="ambiente" id="rdProducao" value="producao"> Produção</label>
                <label class="chk"><input type="radio" name="ambiente" id="rdHomologacao" value="homologacao"> Homologação</label>
                <button id="btnTestarConexao" class="btn">Testar Conexão</button>
              </div>
            </div>

            <div id="modalTeste" class="modal">
              <div class="modal-card">
                <div class="modal-h">Teste de Conexão</div>
                <div class="modal-b">
                  <div id="spinner" class="spinner"></div>
                  <div id="modalMessage">Testando conexão...</div>
                  <button id="btnFecharModal" class="btn" style="margin-top:8px;display:none">OK</button>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>

      <div class="footer">
        <button class="btn">Gravar</button>
        <button class="btn">Excluir</button>
        <button class="btn">Imprimir</button>
        <button class="btn">Fechar</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== Gate de acesso ===== */
(function(){
  const OK='SGH-55914', gate=document.getElementById('gate'), app=document.getElementById('app');
  const code=document.getElementById('gateCode'), btn=document.getElementById('gateBtn'), err=document.getElementById('gateError');
  function unlock(){ gate.style.display='none'; app.style.display='block'; sessionStorage.setItem('conv_auth','ok'); initApp(); }
  if(sessionStorage.getItem('conv_auth')==='ok'){ unlock(); return; }
  btn.addEventListener('click',tryCode); code.addEventListener('keydown',e=>{ if(e.key==='Enter') tryCode(); });
  function tryCode(){ if(code.value.trim()===OK) unlock(); else{ err.textContent='Código inválido.'; code.focus(); code.select(); } }
})();

/* ===== App ===== */
function initApp(){
  // pagecontrol
  const head=document.getElementById('pcHead');
  const pages={fin:document.getElementById('tab-fin'), ip:document.getElementById('tab-ip'),
               fr:document.getElementById('tab-fr'), res:document.getElementById('tab-res')};
  head.addEventListener('click',e=>{
    const t=e.target.closest('.pc-tab'); if(!t||!t.dataset.k) return;
    head.querySelectorAll('.pc-tab').forEach(x=>x.classList.remove('active')); t.classList.add('active');
    Object.values(pages).forEach(p=>p.style.display='none'); pages[t.dataset.k].style.display='block';
  });

  // RES form
  const edtChave = document.getElementById('edtChave');
  const edtValor = document.getElementById('edtValor');
  const btnAdicionar = document.getElementById('btnAdicionar');
  const btnRemoverSelecionada = document.getElementById('btnRemoverSelecionada');
  const btnTestarConexao = document.getElementById('btnTestarConexao');
  const modalTeste = document.getElementById('modalTeste');
  const modalMessage = document.getElementById('modalMessage');
  const spinner = document.getElementById('spinner');
  const btnFecharModal = document.getElementById('btnFecharModal');
  const tblCredenciais = document.getElementById('tblCredenciais').getElementsByTagName('tbody')[0];
  let selectedRow=null;

  function addCredential(chave,valor){
    const row = tblCredenciais.insertRow();
    const c1=row.insertCell(0); c1.textContent=chave;
    const c2=row.insertCell(1); c2.textContent='••••••••';
    row.dataset.valorReal=valor;
    row.addEventListener('click',()=>{ if(selectedRow) selectedRow.classList.remove('selected'); selectedRow=row; row.classList.add('selected'); btnRemoverSelecionada.disabled=false; });
    row.addEventListener('dblclick',()=>{ edtChave.value=row.cells[0].textContent; edtValor.value=row.dataset.valorReal; row.remove(); if(row===selectedRow){selectedRow=null;btnRemoverSelecionada.disabled=true;} edtChave.focus(); });
  }

  btnAdicionar.addEventListener('click',()=>{
    const k=edtChave.value.trim(), v=edtValor.value.trim();
    if(!k){alert('Informe a chave');return;} if(!v){alert('Informe o valor');return;}
    addCredential(k,v); edtChave.value=''; edtValor.value=''; edtChave.focus();
  });

  btnRemoverSelecionada.addEventListener('click',()=>{ if(selectedRow){selectedRow.remove(); selectedRow=null; btnRemoverSelecionada.disabled=true;} });

  btnTestarConexao.addEventListener('click',()=>{
    const rows=tblCredenciais.rows; let clientSecret=null;
    for(let i=0;i<rows.length;i++){ const chave=rows[i].cells[0].textContent.toLowerCase(); if(chave.includes('secret')){ clientSecret=rows[i].dataset.valorReal; break; } }
    modalTeste.style.display='flex'; modalMessage.textContent='Testando conexão...'; modalMessage.className=''; spinner.style.display='block'; btnFecharModal.style.display='none';
    setTimeout(()=>{ spinner.style.display='none'; btnFecharModal.style.display='inline-block';
      if(clientSecret==='a1234567'){ modalMessage.textContent='Erro: HTTP 401 - Não autorizado. Verifique suas credenciais.'; modalMessage.className='msg-error'; }
      else{ modalMessage.textContent='Conexão bem-sucedida!'; modalMessage.className='msg-ok'; }
    },1200);
  });
  btnFecharModal.addEventListener('click',()=> modalTeste.style.display='none');
  modalTeste.addEventListener('click',e=>{ if(e.target===modalTeste) modalTeste.style.display='none'; });

  // exemplos iniciais para o grid não ficar “vazio invisível”
  addCredential('APIKey','12345-67890-ABCDE');
  addCredential('ClientId','client-special-123');
  addCredential('ClientSecret','very-secret-password');
}
</script>
</body>
</html>
